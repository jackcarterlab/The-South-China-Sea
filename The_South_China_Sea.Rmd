---
title: "The South China Sea"
author: "Jack Carter"  
date: "1/9/2021"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr, warn.conflicts = FALSE)
options(dplyr.summarise.inform = FALSE)
library(tidyverse)
library(readxl)
library(ggplot2)
library(ggthemes)
library(naniar)
library(patchwork)
library(rvest)
library(pdftools)
library(patchwork)

# set the working directory
path <- file.path("C:/Users/HUAWEI/Desktop/China-data/The_South_China_Sea/data", fsep = .Platform$file.sep)
setwd(path)

# read in data sets
# read in data sets
population_data <- read_xls("population_imf.xls", range = "A1:AU9") %>%
  rename(country = "Population (Millions of people)") %>%
  slice(-1) %>%
  gather(key = "year", value = "population", -1) %>%
  replace_with_na(replace = list(population = "no data")) %>%
  mutate(population = as.numeric(population))

gdp_data <- read_xls("gdp_imf.xls", range = "A1:AU9") %>%
  rename(country = "GDP, current prices (Purchasing power parity; billions of international dollars)") %>%
  slice(-1) %>%
  gather(key = "year", value = "gdp", -1) %>%
  replace_with_na(replace = list(gdp = "no data")) %>%
  mutate(gdp = as.numeric(gdp))

military_USD_data <- read_xls("Military_spending_USD_World_Bank.xls", range = "A4:BL269") %>%
  gather(key = "year", value = "military_USD", 35:64) %>%
  rename(country = "Country Name") %>%
  subset(select = -c(2:34))
  
# group for analysis
countries <- c("Brunei Darussalam", "China, People's Republic of", "Philippines", "Malaysia", "Taiwan Province of China", "Vietnam")

```

## **1.1: Asymmetric Power**  
Expressed as Gross Domestic Product (GDP) and population in 2019. GDP refers to the total sum of goods and services produced at purchasers prices. Population refers to all residents in a given country *(World Bank, 2020)*. 

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# asymmetric power plot
pop <- population_data %>%
  filter(country %in% countries, year == 2019) %>%
  select(c(country, population))

gdp <- gdp_data %>%
  filter(country %in% countries, year == 2019) %>%
  select(gdp)

military <- military_USD_data %>%
  filter(country %in% countries, year == 2019) %>%
  summarize(military = military_USD)

power_table <- pop %>%
  cbind(gdp) %>%
  cbind(military) %>%
  gather(key = measure, value = value, -1)

power_table %>%
  mutate(measure = as.factor(measure), measure = factor(measure, levels = c("gdp", "population", "military_USD"))) %>%
  ggplot(aes(x = measure, y = value, fill = country)) +
  geom_bar(alpha = 1, stat='identity', position="fill", show.legend = TRUE) +
  ggtitle("Asymetric Power") +
  xlab("") +
  ylab("% of total") +
  scale_x_discrete(labels = c("Population", "GDP", "Military Spending")) +
  scale_fill_manual(values = c("#E6AB02", "#D55E00", "#1B9E77", "#7570B3", "#E7298A", "#66A61E"), labels = c("Brunei", "China", "Malaysia", "Philippines", "Taiwan", "Vietnam")) +
  theme_economist_white(gray_bg = FALSE) +
  theme(plot.title = element_text(hjust = 0.5, size = 10, color = "#474747"),
        plot.margin = unit(c(0.75, 0.75, 0.75, 0.75), "cm"),
        axis.text = element_text(size = 9, color = "gray30"), 
        axis.title.y = element_text(size = 9, color = "gray30", vjust = 2.5),
        legend.direction = "vertical", 
        legend.position = "right",
        legend.title = element_blank(),
        legend.text = element_text(size = 12, color = "gray20"),
        legend.spacing.x = unit(0.25, "cm"),
        legend.key.size = unit(0.5, "cm"), 
        legend.key.height = unit(0.75, "cm"))

```

The data shows a significantly larger population, GDP and military spending for China compared to Brunei, Malaysia, the Philippines, Taiwan and Vietnam. This suggests that China has far greater power over its smaller neighbors. 


